<!DOCTYPE html>
<html>
<head>
<meta charset='UTF-8'/>
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<script src='http://underscorejs.org/underscore-min.js'></script>
<script src='http://api.tiles.mapbox.com/mapbox.js/v0.6.7/mapbox.js'></script>
<link href='http://api.tiles.mapbox.com/mapbox.js/v0.6.7/mapbox.css' rel='stylesheet' />
<script type="text/javascript" src="../routes.js"></script>
<link href='style.css' rel='stylesheet' />
<style>
.d3-vec { position:absolute; }
path {
  fill: #000;
  fill-opacity: .05;
  stroke: orange;
  stroke-opacity: 0.50;
  stroke-width: 15.0px;
  }
</style>
</head>
<body class='section-0'>
<script src='http://d3js.org/d3.v2.min.js'></script>

<div id='pane'><div id='map'></div></div>

<article>

<section id='cover' class='cover active'>
  <h1>From LRT 2 Katipunan Station or Marikina to SOLAIR* and NCPAG**</h1>
  <p>*School of Labor and Industrial Relations<br>**National College of Public Administration and Governance</p>
  <br><br>
    <p>by BEST-Transit</p>
    <small class='scroll'>Scroll ▼</small>  
  </section>

<section id='katips'>
  <h2>Katipunan Jeepney Terminal</h2>
  <p align='justify'>From Marikina, alight at Aurora Blvd corner Katipunan and walk towards the <b>jeepney terminal</b> under the Katipunan Flyover.
  <br><br>
  If you’re coming from the <b>LRT-2 Katipunan Station</b>, take the <b>North Exit</b> on the same side as St. Bridget, opposite PSBA. Walk towards the jeepney terminal under the Katipunan Flyover.
  <br><br>
  There are two queues calling UP at the terminal. Make sure you ride the <b>jeep which goes inside the campus</b> (the jeep line closer to Ministop). The other jeep line (farther from Ministop) goes to Tandang Sora passing through MWSS and will not go inside UP. To be sure, ask the barker before boarding.
</section>

<section id='romulo-shed'>
  <p align='justify'>
  <img src='https://lh6.googleusercontent.com/OoK8Mc7tOKshhMgBIwYZwaSDcfMk2HFxl2H_gh8IhgoL_nFO02O2ksV7_aSHMJ57ci_h94azoFmxmrlke95jSQviVYrBusSSqiWNufPZtaonNx6FEmsOnJmUKA'>
  <br><br>
  The UP-Katipunan jeep enters UP Diliman through the <b>gate opposite MWSS</b> (Manila Water).  The jeep is now on the Magsaysay Ave Road where you can spot the <b>Asian Center</b> on your left.</p>
</section>

<section id='romulo-shed'>
  <img src='https://lh5.googleusercontent.com/U5T0g7v3p6T0H4wXUiroA2QmaXzkmNMITOBY_g1utdcYrFa6KbdotI0Iz8ufjoBPDKMUs9Rur-uYB-YbuQtr9nty5gb6giyO6QzmgprufB82xDm4xMTgcEvb'>
  <br><br>
  <p align='justify'>Alight from the jeep at Romulo Hall. This is the first intersection the UP-Katipunan jeep encounters once inside UP.
  <br><br>
  Go to the Romulo Hall Waiting Shed along E. Ma. Guerrero Road, then ride the next Ikot Jeep that passes by. The Ikot Jeep will take you directly to SOLAIR and NCPAG; both are along its route.
  </p>
</section>

<section id='solair'>
  <p align='justify'>Tell the Ikot Jeep driver that you would like to be dropped off at SOLAIR. From Romulo Hall, the jeep will pass by landmarks such as the UP Health Service, University Shopping Center, and dormitories.
  <br><br>
  The jeep will make a turn towards Magsaysay Ave, then pass by Bahay ng Alumni and CSWCD (College of Social Welfare and Community Development).
  <br><br>
  When you reach Ylanan Hall (College of Human Kinetics) or more commonly known as the Gym, the Ikot Jeep will make a left turn to E. Jacinto St.</p>
</section>

<section id='solair'>
  <h2>SOLAIR (School of Labor and Industrial Relations)</h2>
   <img src='https://lh4.googleusercontent.com/iEnctAascONqAUimJdcIDSHdf870nR5BsVkUJ-tQ9vK8GJcRNW9gT20wDsNHrgE56g7GZ3vlyPcsLClZdnwAkD97QvgnQVUOXiiuG9K7zlmfqwrFa0xXct-I'>
  <p align='justify'><b>SOLAIR</b> will be the first building you see on your right after the jeep makes a turn at E. Jacinto.</p>
</section>

<section id='ncpag'>
  <h2>NCPAG (National College of Public Administration and Governance)</h2>
  <p align='justify'>The <b>NCPAG complex</b> can be reached on foot from SOLAIR or you may tell the Ikot Jeep driver to take you inside the complex.
  <br><br>  
  <img src='https://lh5.googleusercontent.com/MR-SUbfXTFvNlf6VpJrDDA7xmlQyVS2SHSLVb0oFKtE2AYAAnXvlsVgR5GI-GObwFI5qGgXILabhJ_1oyLsGwpuM_PdrgUou7MsmCNlA5KJBTuOfYRMTLVGU'>
  <br><br>
  If you informed the driver prior, instead of turning left at the first corner (towards E. Jacinto St) after passing by Ylanan Hall, the jeep turns left at the second corner (past the Archery Range) going through a street that leads to the NCPAG Complex.</p>
</section>


</article>

<script>
//For the D3 layer
function d3layer() {
    var f = {}, bounds, feature, collection;
    var div = d3.select(document.body)
        .append("div")
        .attr('class', 'd3-vec'),
        svg = div.append('svg'),
        g = svg.append("g");

    f.parent = div.node();

    f.project = function(x) {
      var point = f.map.locationPoint({ lat: x[1], lon: x[0] });
      return [point.x, point.y];
    };

    var first = true;
    f.draw = function() {
      first && svg.attr("width", f.map.dimensions.x)
          .attr("height", f.map.dimensions.y)
          .style("margin-left", "0px")
          .style("margin-top", "0px") && (first = false);

      path = d3.geo.path().projection(f.project);
      feature.attr("d", path);
    };

    f.data = function(x) {
        collection = x;
        bounds = d3.geo.bounds(collection);
        feature = g.selectAll("path")
            .data(collection.features)
            .enter().append("path");
        return f;
    };

    f.extent = function() {
        return new MM.Extent(
            new MM.Location(bounds[0][1], bounds[0][0]),
            new MM.Location(bounds[1][1], bounds[1][0]));
    };
    return f;
}

var tiles = mapbox.layer().tilejson({
  tiles: [ "http://a.tiles.mapbox.com/v3/examples.map-liczq28b/{z}/{x}/{y}.png" ]
});
var spots = mapbox.markers.layer()
  // Load up markers from geojson data.
  .features(geojson)
  // Define a new factory function. Takes geojson input and returns a
  // DOM element that represents the point.
  .factory(function(f) {
    var el = document.createElement('div');
    el.className = 'spot spot-' + f.properties.id;
    return el;
  });
// Creates the map with tile and marker layers and
// no input handlers (mouse drag, scrollwheel, etc).
var map = mapbox.map('map', [spots], null, []);

//Add baselayer
map.addLayer(new MM.TemplatedLayer('http://c.tiles.mapbox.com/v3/examples.map-szwdot65/{Z}/{X}/{Y}.png'));
map.ui.attribution.add()
    .content('Map tiles by <a href="http://stamen.com">Mapbox</a>, under' +
    ' <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>.' +
    ' Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.');
// Add Jeep Route
var jeep = d3layer().data(katips);
var yellow = d3layer().data(ikot);
map.addLayer(jeep);
map.addLayer(yellow)


map.addLayer(spots);

// Array of story section elements.
var sections = document.getElementsByTagName('section');

// Array of marker elements with order matching section elements.
var markers = _(sections).map(function(section) {
  return _(spots.markers()).find(function(m) {
    return m.data.properties.id === section.id;
  });
});

// Helper to set the active section.
var setActive = function(index, ease) {
  // Set active class on sections, markers.
  _(sections).each(function(s) { s.className = s.className.replace(' active', '') });
  _(markers).each(function(m) { m.element.className = m.element.className.replace(' active', '') });
  sections[index].className += ' active';
  markers[index].element.className += ' active';

  // Set a body class for the active section.
  document.body.className = 'section-' + index;

  // Ease map to active marker.
  if (!ease) {
    map.centerzoom(markers[index].location, markers[index].data.properties.zoom||20);
  } else {
    map.ease.location(markers[index].location).zoom(markers[index].data.properties.zoom||20).optimal(0.5, 2);
  }

  return true;
};

// Bind to scroll events to find the active section.
window.onscroll = _(function() {
  // IE 8
  if (window.pageYOffset === undefined) {
    var y = document.documentElement.scrollTop;
    var h = document.documentElement.clientHeight;
  } else {
    var y = window.pageYOffset;
    var h = window.innerHeight;
  }

  // If scrolled to the very top of the page set the first section active.
  if (y === 0) return setActive(0, true);

  // Otherwise, conditionally determine the extent to which page must be
  // scrolled for each section. The first section that matches the current
  // scroll position wins and exits the loop early.
  var memo = 0;
  var buffer = (h * 0.3333);
  var active = _(sections).any(function(el, index) {
    memo += el.offsetHeight;
    return y < (memo-buffer) ? setActive(index, true) : false;
  });

  // If no section was set active the user has scrolled past the last section.
  // Set the last section active.
  if (!active) setActive(sections.length - 1, true);
}).debounce(10);

// Set map to first section.
setActive(0, false);


//var myLayer = L.geoJson(ikot).addTo(map);
</script>

</body>
</html>
